<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Copilot for MS365 Training – Clean Version</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    transition: background 0.3s, color 0.3s;
  }
  body.dark { background: #222; color: #eee; }
  #toc {
    position: fixed;
    top: 0;
    left: 0;
    width: 260px;
    height: 100%;
    overflow-y: auto;
    background: #fff;
    border-right: 1px solid #ccc;
    padding: 20px;
  }
  body.dark #toc { background: #333; border-right-color: #555; }
  #toc a {
    display: block;
    margin-bottom: 10px;
    text-decoration: none;
    color: inherit;
    cursor: pointer;
  }
  #toc a.active { font-weight: bold; text-decoration: underline; }
  #main { margin-left: 280px; padding: 20px; }
  .slide { display: none; opacity: 0; transition: opacity 0.5s ease; }
  .slide.active { display: block; opacity: 1; }
  .progress-dots { text-align: center; margin-top: 10px; }
  .dot {
    display: inline-block;
    width: 12px; height: 12px;
    margin: 4px; border-radius: 50%;
    background: #999; cursor: pointer;
  }
  .dot.active { background: #000; }
  body.dark .dot.active { background: #fff; }
  .quiz-question {
    margin-top: 20px;
    padding: 15px;
    background: #eaeaea;
    border-radius: 8px;
  }
  body.dark .quiz-question { background: #444; }
  .quiz-feedback { margin-top: 10px; font-weight: bold; }
  #overview {
    display: none;
    position: fixed; top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,.8); color: #fff;
    overflow: auto; padding: 40px;
  }
  #overview div { margin: 20px; padding: 20px; background: #333; cursor: pointer; }
</style>
</head>
<body>

<div id="toc"></div>
<div id="main">
  <div id="slides"></div>
  <div class="progress-dots" id="dots"></div>
</div>
<div id="overview"></div>

<script>
// --- Slides Data ---
const slideData = [
  { title: "Welcome", content: "<p>Welcome to the enhanced Copilot training.</p>" },
  { title: "Overview", content: "<p>This course covers features, usage, and challenges.</p>" },
  { title: "Quick Quiz", content: `
    <p>Which version of Copilot is used for Microsoft 365 apps?</p>
    <div class='quiz-question'>
      <label><input type='radio' name='q1' value='wrong'> GitHub Copilot</label><br>
      <label><input type='radio' name='q1' value='correct'> Copilot for Microsoft 365</label><br>
      <label><input type='radio' name='q1' value='wrong'> Copilot Pro (personal)</label>
      <div class='quiz-feedback' id='q1-feedback'></div>
    </div>
  `, quiz: { name: "q1", correct: "correct", feedbackId: "q1-feedback" } }
];

// Build slides
const slidesContainer = document.getElementById("slides");
slideData.forEach((s,i)=>{
  const div = document.createElement('div');
  div.className = 'slide';
  div.id = 'slide-'+i;
  div.innerHTML = `<h2>${s.title}</h2>${s.content}`;
  slidesContainer.appendChild(div);
});

let current = 0;
showSlide(0);

function showSlide(i){
  document.querySelectorAll('.slide').forEach(s=>s.classList.remove('active'));
  const el = document.getElementById('slide-'+i);
  if(el) el.classList.add('active');
  current = i;
  updateTOC();
  updateDots();
}
function nextSlide(){ if(current < slideData.length-1) showSlide(current+1); }
function prevSlide(){ if(current > 0) showSlide(current-1); }

// Keyboard navigation
document.addEventListener('keydown', e=>{
  if(e.key==='ArrowRight') nextSlide();
  if(e.key==='ArrowLeft') prevSlide();
  if(e.key==='d') document.body.classList.toggle('dark'); // press 'd' for dark mode
  if(e.key==='o') toggleOverview(); // press 'o' for overview
});

// TOC
const toc = document.getElementById("toc");
slideData.forEach((s,i)=>{
  const a = document.createElement('a');
  a.textContent = s.title;
  a.onclick = ()=> showSlide(i);
  a.id='toc-'+i;
  toc.appendChild(a);
});
function updateTOC(){
  document.querySelectorAll('#toc a').forEach(a=>a.classList.remove('active'));
  const active = document.getElementById('toc-'+current);
  if(active) active.classList.add('active');
}

// Dots
const dots = document.getElementById('dots');
slideData.forEach((_,i)=>{
  const d = document.createElement('span');
  d.className='dot';
  d.onclick = ()=>showSlide(i);
  d.id='dot-'+i;
  dots.appendChild(d);
});
function updateDots(){
  document.querySelectorAll('.dot').forEach(d=>d.classList.remove('active'));
  const active = document.getElementById('dot-'+current);
  if(active) active.classList.add('active');
}

// Overview Mode
function toggleOverview(){
  const o = document.getElementById('overview');
  if(o.style.display==='none'){
    o.innerHTML='';
    slideData.forEach((s,i)=>{
      const div = document.createElement('div');
      div.innerHTML = `<h3>${s.title}</h3><p>${s.content.substring(0,120)}...</p>`;
      div.onclick = ()=>{ o.style.display='none'; showSlide(i); };
      o.appendChild(div);
    });
    o.style.display='block';
  } else { o.style.display='none'; }
}

// Quiz logic
slidesContainer.addEventListener('change', e=>{
  const slide = slideData[current];
  if(!slide.quiz) return;
  const q = slide.quiz;
  if(e.target.name===q.name){
    const feedback = document.getElementById(q.feedbackId);
    if(e.target.value===q.correct){
      feedback.textContent="Correct! Well done.";
      feedback.style.color="green";
    } else {
      feedback.textContent="Incorrect — this option does not represent Copilot for Microsoft 365.";
      feedback.style.color="red";
    }
  }
});
</script>
</body>
</html>
